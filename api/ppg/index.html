
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="PhysioKit, process raw ambulatory bio-signals">
      
      
      
      
        <link rel="prev" href="../ecg/">
      
      
        <link rel="next" href="../rsp/">
      
      
      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.6">
    
    
      
        <title>PPG - PhysioKit</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/termynal.css">
    
      <link rel="stylesheet" href="../../css/custom.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#photoplethysmography-ppg" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="PhysioKit" class="md-header__button md-logo" aria-label="PhysioKit" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PhysioKit
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PPG
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Use system theme"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Use system theme" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Switch to light theme"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light theme" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Switch to dark theme"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark theme" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/AmbiqAI/physiokit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    AmbiqAI/physiokit
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="PhysioKit" class="md-nav__button md-logo" aria-label="PhysioKit" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    PhysioKit
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/AmbiqAI/physiokit" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    AmbiqAI/physiokit
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PhysioKit
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting Started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick Start
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Signals
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Signals
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../signals/ecg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ECG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../signals/ppg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PPG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../signals/rsp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RSP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../signals/imu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IMU
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../signals/hrv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HRV
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../signals/signal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Signal
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ecg/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ECG
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    PPG
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    PPG
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#physiokit.ppg.clean" class="md-nav__link">
    <span class="md-ellipsis">
      clean
    </span>
  </a>
  
    <nav class="md-nav" aria-label="clean">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.clean.clean" class="md-nav__link">
    <span class="md-ellipsis">
      clean
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physiokit.ppg.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      metrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.metrics.compute_heart_rate" class="md-nav__link">
    <span class="md-ellipsis">
      compute_heart_rate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.metrics.compute_heart_rate_from_fft" class="md-nav__link">
    <span class="md-ellipsis">
      compute_heart_rate_from_fft
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.metrics.compute_heart_rate_from_peaks" class="md-nav__link">
    <span class="md-ellipsis">
      compute_heart_rate_from_peaks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.metrics.compute_spo2_from_perfusion" class="md-nav__link">
    <span class="md-ellipsis">
      compute_spo2_from_perfusion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.metrics.compute_spo2_in_frequency" class="md-nav__link">
    <span class="md-ellipsis">
      compute_spo2_in_frequency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.metrics.compute_spo2_in_time" class="md-nav__link">
    <span class="md-ellipsis">
      compute_spo2_in_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.metrics.derive_respiratory_rate" class="md-nav__link">
    <span class="md-ellipsis">
      derive_respiratory_rate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physiokit.ppg.peaks" class="md-nav__link">
    <span class="md-ellipsis">
      peaks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="peaks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.peaks.compute_rr_intervals" class="md-nav__link">
    <span class="md-ellipsis">
      compute_rr_intervals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.peaks.filter_peaks" class="md-nav__link">
    <span class="md-ellipsis">
      filter_peaks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.peaks.filter_rr_intervals" class="md-nav__link">
    <span class="md-ellipsis">
      filter_rr_intervals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.peaks.find_peaks" class="md-nav__link">
    <span class="md-ellipsis">
      find_peaks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physiokit.ppg.synthesize" class="md-nav__link">
    <span class="md-ellipsis">
      synthesize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="synthesize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.synthesize.synthesize" class="md-nav__link">
    <span class="md-ellipsis">
      synthesize
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rsp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RSP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../imu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IMU
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../hrv/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HRV
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../signal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Signal
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#physiokit.ppg.clean" class="md-nav__link">
    <span class="md-ellipsis">
      clean
    </span>
  </a>
  
    <nav class="md-nav" aria-label="clean">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.clean.clean" class="md-nav__link">
    <span class="md-ellipsis">
      clean
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physiokit.ppg.metrics" class="md-nav__link">
    <span class="md-ellipsis">
      metrics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="metrics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.metrics.compute_heart_rate" class="md-nav__link">
    <span class="md-ellipsis">
      compute_heart_rate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.metrics.compute_heart_rate_from_fft" class="md-nav__link">
    <span class="md-ellipsis">
      compute_heart_rate_from_fft
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.metrics.compute_heart_rate_from_peaks" class="md-nav__link">
    <span class="md-ellipsis">
      compute_heart_rate_from_peaks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.metrics.compute_spo2_from_perfusion" class="md-nav__link">
    <span class="md-ellipsis">
      compute_spo2_from_perfusion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.metrics.compute_spo2_in_frequency" class="md-nav__link">
    <span class="md-ellipsis">
      compute_spo2_in_frequency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.metrics.compute_spo2_in_time" class="md-nav__link">
    <span class="md-ellipsis">
      compute_spo2_in_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.metrics.derive_respiratory_rate" class="md-nav__link">
    <span class="md-ellipsis">
      derive_respiratory_rate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physiokit.ppg.peaks" class="md-nav__link">
    <span class="md-ellipsis">
      peaks
    </span>
  </a>
  
    <nav class="md-nav" aria-label="peaks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.peaks.compute_rr_intervals" class="md-nav__link">
    <span class="md-ellipsis">
      compute_rr_intervals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.peaks.filter_peaks" class="md-nav__link">
    <span class="md-ellipsis">
      filter_peaks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.peaks.filter_rr_intervals" class="md-nav__link">
    <span class="md-ellipsis">
      filter_rr_intervals
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.peaks.find_peaks" class="md-nav__link">
    <span class="md-ellipsis">
      find_peaks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#physiokit.ppg.synthesize" class="md-nav__link">
    <span class="md-ellipsis">
      synthesize
    </span>
  </a>
  
    <nav class="md-nav" aria-label="synthesize">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#physiokit.ppg.synthesize.synthesize" class="md-nav__link">
    <span class="md-ellipsis">
      synthesize
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="photoplethysmography-ppg">Photoplethysmography (PPG)</h1>
<p>Photoplethysmography (PPG) is a non-invasive optical technique used to measure blood volume changes in the microvascular bed of tissue. PPG signals are often used to measure heart rate, heart rate variability (HRV), respiratory rate, and oxygen saturation (SpO2). In PhysioKit, we provide a variety of routines for processing PPG signals.</p>


<div class="doc doc-object doc-module">



<h3 id="physiokit.ppg.clean" class="doc doc-heading">
          <code>physiokit.ppg.clean</code>


</h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="physiokit.ppg.clean.clean" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">clean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">forward_backward</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Clean PPG signal using biquad filter.</p>
<p>By default applies a 3rd order Butterworth filter between 0.5 and 4 Hz.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>data</code></b>
            (<code><span title="numpy.NDArray">NDArray</span></code>)
        –
        <div class="doc-md-description">
          <p>Signal</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>lowcut</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>0.5</code>
)
        –
        <div class="doc-md-description">
          <p>Lower cutoff in Hz. Defaults to 0.5 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>highcut</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>4</code>
)
        –
        <div class="doc-md-description">
          <p>Upper cutoff in Hz. Defaults to 4 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>sample_rate</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>1000</code>
)
        –
        <div class="doc-md-description">
          <p>Sample rate in Hz. Defaults to 1000 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>order</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                <code>3</code>
)
        –
        <div class="doc-md-description">
          <p>Filter order. Defaults to 3 (3rd order Butterworth filter).</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>axis</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                <code>-1</code>
)
        –
        <div class="doc-md-description">
          <p>Axis to apply against. Defaults to -1.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>forward_backward</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>, default:
                <code>True</code>
)
        –
        <div class="doc-md-description">
          <p>Apply filter forward and backward. Defaults to True.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="numpy.NDArray">NDArray</span></code>
        –
        <div class="doc-md-description">
          <p>npt.NDArray: Cleaned signal</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>physiokit/ppg/clean.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="k">def</span> <span class="nf">clean</span><span class="p">(</span>
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="n">data</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    <span class="n">lowcut</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    <span class="n">highcut</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="n">sample_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="n">order</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">axis</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="n">forward_backward</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Clean PPG signal using biquad filter.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    By default applies a 3rd order Butterworth filter between 0.5 and 4 Hz.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        data (npt.NDArray): Signal</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        lowcut (float, optional): Lower cutoff in Hz. Defaults to 0.5 Hz.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        highcut (float, optional): Upper cutoff in Hz. Defaults to 4 Hz.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        sample_rate (float, optional): Sample rate in Hz. Defaults to 1000 Hz.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        order (int, optional): Filter order. Defaults to 3 (3rd order Butterworth filter).</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        axis (int, optional): Axis to apply against. Defaults to -1.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        forward_backward (bool, optional): Apply filter forward and backward. Defaults to True.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        npt.NDArray: Cleaned signal</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="k">return</span> <span class="n">filter_signal</span><span class="p">(</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>        <span class="n">lowcut</span><span class="o">=</span><span class="n">lowcut</span><span class="p">,</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>        <span class="n">highcut</span><span class="o">=</span><span class="n">highcut</span><span class="p">,</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>        <span class="n">sample_rate</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">,</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>        <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>        <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">,</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="n">forward_backward</span><span class="o">=</span><span class="n">forward_backward</span><span class="p">,</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="physiokit.ppg.metrics" class="doc doc-heading">
          <code>physiokit.ppg.metrics</code>


</h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="physiokit.ppg.metrics.compute_heart_rate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">compute_heart_rate</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fft&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Compute heart rate in BPM from PPG signal.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>data</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/array.html#module-array">array</a></code>)
        –
        <div class="doc-md-description">
          <p>PPG signal.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>sample_rate</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>1000</code>
)
        –
        <div class="doc-md-description">
          <p>Sampling rate in Hz. Defaults to 1000 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>method</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>, default:
                <code>&#39;fft&#39;</code>
)
        –
        <div class="doc-md-description">
          <p>Method to compute heart rate. Defaults to 'fft'.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>**kwargs</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a></code>, default:
                <code>{}</code>
)
        –
        <div class="doc-md-description">
          <p>Keyword arguments to pass to method.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
<b><code>float</code></b> (            <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code>
)        –
        <div class="doc-md-description">
          <p>Heart rate in BPM.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>physiokit/ppg/metrics.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="k">def</span> <span class="nf">compute_heart_rate</span><span class="p">(</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">data</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">sample_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;fft&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute heart rate in BPM from PPG signal.</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">        data (array): PPG signal.</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        sample_rate (float, optional): Sampling rate in Hz. Defaults to 1000 Hz.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        method (str, optional): Method to compute heart rate. Defaults to &#39;fft&#39;.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        **kwargs (dict): Keyword arguments to pass to method.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">        float: Heart rate in BPM.</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a>    <span class="k">match</span> <span class="n">method</span><span class="p">:</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a>        <span class="k">case</span> <span class="s2">&quot;fft&quot;</span><span class="p">:</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>            <span class="n">bpm</span><span class="p">,</span> <span class="n">qos</span> <span class="o">=</span> <span class="n">compute_heart_rate_from_fft</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>        <span class="k">case</span> <span class="s2">&quot;peak&quot;</span><span class="p">:</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>            <span class="n">bpm</span><span class="p">,</span> <span class="n">qos</span> <span class="o">=</span> <span class="n">compute_heart_rate_from_peaks</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Heart rate computation method </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2"> not implemented.&quot;</span><span class="p">)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="c1"># END MATCH</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="k">return</span> <span class="n">bpm</span><span class="p">,</span> <span class="n">qos</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="physiokit.ppg.metrics.compute_heart_rate_from_fft" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">compute_heart_rate_from_fft</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mf">4.0</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Compute heart rate from FFT of PPG signal.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>data</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/array.html#module-array">array</a></code>)
        –
        <div class="doc-md-description">
          <p>PPG signal.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>sample_rate</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>1000</code>
)
        –
        <div class="doc-md-description">
          <p>Sampling rate in Hz. Defaults to 1000 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>lowcut</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>0.5</code>
)
        –
        <div class="doc-md-description">
          <p>Lowcut frequency in Hz. Defaults to 0.5 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>highcut</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>4.0</code>
)
        –
        <div class="doc-md-description">
          <p>Highcut frequency in Hz. Defaults to 4.0 Hz.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code>
        –
        <div class="doc-md-description">
          <p>tuple[float, float]: Heart rate (BPM) and qos metric.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>physiokit/ppg/metrics.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span>
<span class="normal"><a href="#__codelineno-0-72">72</a></span>
<span class="normal"><a href="#__codelineno-0-73">73</a></span>
<span class="normal"><a href="#__codelineno-0-74">74</a></span>
<span class="normal"><a href="#__codelineno-0-75">75</a></span>
<span class="normal"><a href="#__codelineno-0-76">76</a></span>
<span class="normal"><a href="#__codelineno-0-77">77</a></span>
<span class="normal"><a href="#__codelineno-0-78">78</a></span>
<span class="normal"><a href="#__codelineno-0-79">79</a></span>
<span class="normal"><a href="#__codelineno-0-80">80</a></span>
<span class="normal"><a href="#__codelineno-0-81">81</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="k">def</span> <span class="nf">compute_heart_rate_from_fft</span><span class="p">(</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="n">data</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">sample_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">lowcut</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">highcut</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">4.0</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute heart rate from FFT of PPG signal.</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">        data (array): PPG signal.</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">        sample_rate (float, optional): Sampling rate in Hz. Defaults to 1000 Hz.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        lowcut (float, optional): Lowcut frequency in Hz. Defaults to 0.5 Hz.</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">        highcut (float, optional): Highcut frequency in Hz. Defaults to 4.0 Hz.</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        tuple[float, float]: Heart rate (BPM) and qos metric.</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">freqs</span><span class="p">,</span> <span class="n">sp</span> <span class="o">=</span> <span class="n">compute_fft</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sample_rate</span><span class="p">)</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">l_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">freqs</span> <span class="o">&gt;=</span> <span class="n">lowcut</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">r_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">freqs</span> <span class="o">&gt;=</span> <span class="n">highcut</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="n">freqs</span> <span class="o">=</span> <span class="n">freqs</span><span class="p">[</span><span class="n">l_idx</span><span class="p">:</span><span class="n">r_idx</span><span class="p">]</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="n">ps</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sp</span><span class="p">[</span><span class="n">l_idx</span><span class="p">:</span><span class="n">r_idx</span><span class="p">])</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">fft_pk_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">bpm</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">*</span> <span class="n">freqs</span><span class="p">[</span><span class="n">fft_pk_idx</span><span class="p">]</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="n">qos</span> <span class="o">=</span> <span class="n">ps</span><span class="p">[</span><span class="n">fft_pk_idx</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ps</span><span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="k">return</span> <span class="n">bpm</span><span class="p">,</span> <span class="n">qos</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="physiokit.ppg.metrics.compute_heart_rate_from_peaks" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">compute_heart_rate_from_peaks</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">min_rr</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">max_rr</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">min_delta</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Compute heart rate from peaks of PPG signal.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>data</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/array.html#module-array">array</a></code>)
        –
        <div class="doc-md-description">
          <p>PPG signal.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>sample_rate</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>1000</code>
)
        –
        <div class="doc-md-description">
          <p>Sampling rate in Hz. Defaults to 1000 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>min_rr</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>0.3</code>
)
        –
        <div class="doc-md-description">
          <p>Minimum RR interval in seconds. Defaults to 0.3 s.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>max_rr</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>2.0</code>
)
        –
        <div class="doc-md-description">
          <p>Maximum RR interval in seconds. Defaults to 2.0 s.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>min_delta</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>0.3</code>
)
        –
        <div class="doc-md-description">
          <p>Minimum RR interval delta. Defaults to 0.3.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code>
        –
        <div class="doc-md-description">
          <p>tuple[float, float]: Heart rate (BPM) and qos metric.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>physiokit/ppg/metrics.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-36" name="__codelineno-0-36"></a><span class="k">def</span> <span class="nf">compute_heart_rate_from_peaks</span><span class="p">(</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="n">data</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">sample_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">min_rr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">max_rr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">min_delta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute heart rate from peaks of PPG signal.</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a><span class="sd">        data (array): PPG signal.</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a><span class="sd">        sample_rate (float, optional): Sampling rate in Hz. Defaults to 1000 Hz.</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="sd">        min_rr (float, optional): Minimum RR interval in seconds. Defaults to 0.3 s.</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="sd">        max_rr (float, optional): Maximum RR interval in seconds. Defaults to 2.0 s.</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a><span class="sd">        min_delta (float, optional): Minimum RR interval delta. Defaults to 0.3.</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a><span class="sd">        tuple[float, float]: Heart rate (BPM) and qos metric.</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="n">peaks</span> <span class="o">=</span> <span class="n">find_peaks</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">)</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="n">rri</span> <span class="o">=</span> <span class="n">compute_rr_intervals</span><span class="p">(</span><span class="n">peaks</span><span class="o">=</span><span class="n">peaks</span><span class="p">)</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="n">rmask</span> <span class="o">=</span> <span class="n">filter_rr_intervals</span><span class="p">(</span><span class="n">rr_ints</span><span class="o">=</span><span class="n">rri</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">,</span> <span class="n">min_rr</span><span class="o">=</span><span class="n">min_rr</span><span class="p">,</span> <span class="n">max_rr</span><span class="o">=</span><span class="n">max_rr</span><span class="p">,</span> <span class="n">min_delta</span><span class="o">=</span><span class="n">min_delta</span><span class="p">)</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">bpm</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">rri</span><span class="p">[</span><span class="n">rmask</span> <span class="o">==</span> <span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">sample_rate</span><span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="n">qos</span> <span class="o">=</span> <span class="n">rmask</span><span class="p">[</span><span class="n">rmask</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">/</span> <span class="n">rmask</span><span class="o">.</span><span class="n">size</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="k">return</span> <span class="n">bpm</span><span class="p">,</span> <span class="n">qos</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="physiokit.ppg.metrics.compute_spo2_from_perfusion" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">compute_spo2_from_perfusion</span><span class="p">(</span><span class="n">dc1</span><span class="p">,</span> <span class="n">ac1</span><span class="p">,</span> <span class="n">dc2</span><span class="p">,</span> <span class="n">ac2</span><span class="p">,</span> <span class="n">coefs</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Compute SpO2 from ratio of perfusion indexes (AC/DC).</p>

<details class="device-coefficients" open>
  <summary>Device Coefficients</summary>
  <ul>
<li>MAX30101: [1.5958422, -34.6596622, 112.6898759]</li>
<li>MAX8614X: [-16.666666, 8.333333, 100]</li>
</ul>
</details>


  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>dc1</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
        –
        <div class="doc-md-description">
          <p>DC component of 1st PPG signal (e.g RED).</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>ac1</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
        –
        <div class="doc-md-description">
          <p>AC component of 1st PPG signal (e.g RED).</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>dc2</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
        –
        <div class="doc-md-description">
          <p>DC component of 2nd PPG signal (e.g. IR).</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>ac2</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>)
        –
        <div class="doc-md-description">
          <p>AC component of 2nd PPG signal (e.g. IR).</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>coefs</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code>, default:
                <code>(1, 0, 0)</code>
)
        –
        <div class="doc-md-description">
          <p>Calibration coefficients. Defaults to (1, 0, 0).</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
<b><code>float</code></b> (            <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
)        –
        <div class="doc-md-description">
          <p>SpO2 value clipped to [50, 100].</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>physiokit/ppg/metrics.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-151" name="__codelineno-0-151"></a><span class="k">def</span> <span class="nf">compute_spo2_from_perfusion</span><span class="p">(</span>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="n">dc1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ac1</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">dc2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ac2</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">coefs</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute SpO2 from ratio of perfusion indexes (AC/DC).</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a><span class="sd">    Device Coefficients:</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a><span class="sd">        * MAX30101: [1.5958422, -34.6596622, 112.6898759]</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a><span class="sd">        * MAX8614X: [-16.666666, 8.333333, 100]</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="sd">        dc1 (float): DC component of 1st PPG signal (e.g RED).</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        ac1 (float): AC component of 1st PPG signal (e.g RED).</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        dc2 (float): DC component of 2nd PPG signal (e.g. IR).</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a><span class="sd">        ac2 (float): AC component of 2nd PPG signal (e.g. IR).</span>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        coefs (tuple[float, float, float], optional): Calibration coefficients. Defaults to (1, 0, 0).</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        float: SpO2 value clipped to [50, 100].</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a>    <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">ac1</span> <span class="o">/</span> <span class="n">dc1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">ac2</span> <span class="o">/</span> <span class="n">dc2</span><span class="p">)</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a>    <span class="n">spo2</span> <span class="o">=</span> <span class="n">coefs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">coefs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">r</span> <span class="o">+</span> <span class="n">coefs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a>    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">spo2</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="mi">50</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="physiokit.ppg.metrics.compute_spo2_in_frequency" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">compute_spo2_in_frequency</span><span class="p">(</span><span class="n">ppg1</span><span class="p">,</span> <span class="n">ppg2</span><span class="p">,</span> <span class="n">coefs</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">sample_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Compute SpO2 from PPG signals in frequency domain.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>ppg1</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/array.html#module-array">array</a></code>)
        –
        <div class="doc-md-description">
          <p>1st PPG signal (e.g RED).</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>ppg2</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/array.html#module-array">array</a></code>)
        –
        <div class="doc-md-description">
          <p>2nd PPG signal (e.g. IR).</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>coefs</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code>, default:
                <code>(1, 0, 0)</code>
)
        –
        <div class="doc-md-description">
          <p>Calibration coefficients. Defaults to (1, 0, 0).</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>sample_rate</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>1000</code>
)
        –
        <div class="doc-md-description">
          <p>Sampling rate in Hz. Defaults to 1000 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>lowcut</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>0.5</code>
)
        –
        <div class="doc-md-description">
          <p>Lowcut frequency in Hz. Defaults to 0.5 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>highcut</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>4.0</code>
)
        –
        <div class="doc-md-description">
          <p>Highcut frequency in Hz. Defaults to 4.0 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>order</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                <code>3</code>
)
        –
        <div class="doc-md-description">
          <p>Order of filter. Defaults to 3.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
<b><code>float</code></b> (            <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
)        –
        <div class="doc-md-description">
          <p>SpO2 value</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>physiokit/ppg/metrics.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span>
<span class="normal"><a href="#__codelineno-0-275">275</a></span>
<span class="normal"><a href="#__codelineno-0-276">276</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-220" name="__codelineno-0-220"></a><span class="k">def</span> <span class="nf">compute_spo2_in_frequency</span><span class="p">(</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>    <span class="n">ppg1</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>    <span class="n">ppg2</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="n">coefs</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="n">sample_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="n">lowcut</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>    <span class="n">highcut</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>    <span class="n">order</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute SpO2 from PPG signals in frequency domain.</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a><span class="sd">        ppg1 (array): 1st PPG signal (e.g RED).</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a><span class="sd">        ppg2 (array): 2nd PPG signal (e.g. IR).</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a><span class="sd">        coefs (tuple[float, float, float], optional): Calibration coefficients. Defaults to (1, 0, 0).</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a><span class="sd">        sample_rate (float, optional): Sampling rate in Hz. Defaults to 1000 Hz.</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a><span class="sd">        lowcut (float, optional): Lowcut frequency in Hz. Defaults to 0.5 Hz.</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a><span class="sd">        highcut (float, optional): Highcut frequency in Hz. Defaults to 4.0 Hz.</span>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a><span class="sd">        order (int, optional): Order of filter. Defaults to 3.</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a><span class="sd">        float: SpO2 value</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>    <span class="c1"># Compute DC</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>    <span class="n">ppg1_dc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ppg1</span><span class="p">)</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>    <span class="n">ppg2_dc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ppg2</span><span class="p">)</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>    <span class="c1"># Bandpass filter</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>    <span class="n">ppg1_clean</span> <span class="o">=</span> <span class="n">filter_signal</span><span class="p">(</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="n">data</span><span class="o">=</span><span class="n">ppg1</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="n">lowcut</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="n">highcut</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">forward_backward</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>    <span class="p">)</span>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>    <span class="n">ppg2_clean</span> <span class="o">=</span> <span class="n">filter_signal</span><span class="p">(</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="n">data</span><span class="o">=</span><span class="n">ppg2</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="n">lowcut</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="n">highcut</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">forward_backward</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>    <span class="p">)</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>    <span class="c1"># Compute AC via FFT</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>    <span class="n">freqs</span><span class="p">,</span> <span class="n">ppg1_fft</span> <span class="o">=</span> <span class="n">compute_fft</span><span class="p">(</span><span class="n">ppg1_clean</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">)</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>    <span class="n">freqs</span><span class="p">,</span> <span class="n">ppg2_fft</span> <span class="o">=</span> <span class="n">compute_fft</span><span class="p">(</span><span class="n">ppg2_clean</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">)</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>    <span class="n">l_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">freqs</span> <span class="o">&gt;=</span> <span class="n">lowcut</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>    <span class="n">r_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">freqs</span> <span class="o">&gt;=</span> <span class="n">highcut</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>    <span class="n">freqs</span> <span class="o">=</span> <span class="n">freqs</span><span class="p">[</span><span class="n">l_idx</span><span class="p">:</span><span class="n">r_idx</span><span class="p">]</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>    <span class="n">ppg1_ps</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ppg1_fft</span><span class="p">[</span><span class="n">l_idx</span><span class="p">:</span><span class="n">r_idx</span><span class="p">])</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>    <span class="n">ppg2_ps</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ppg2_fft</span><span class="p">[</span><span class="n">l_idx</span><span class="p">:</span><span class="n">r_idx</span><span class="p">])</span>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="c1"># Find peak</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>    <span class="n">fft_pk_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">ppg1_ps</span> <span class="o">+</span> <span class="n">ppg2_ps</span><span class="p">)</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>    <span class="c1"># Compute AC</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>    <span class="n">ppg1_ac</span> <span class="o">=</span> <span class="n">ppg1_ps</span><span class="p">[</span><span class="n">fft_pk_idx</span><span class="p">]</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>    <span class="n">ppg2_ac</span> <span class="o">=</span> <span class="n">ppg2_ps</span><span class="p">[</span><span class="n">fft_pk_idx</span><span class="p">]</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="n">spo2</span> <span class="o">=</span> <span class="n">compute_spo2_from_perfusion</span><span class="p">(</span><span class="n">dc1</span><span class="o">=</span><span class="n">ppg1_dc</span><span class="p">,</span> <span class="n">ac1</span><span class="o">=</span><span class="n">ppg1_ac</span><span class="p">,</span> <span class="n">dc2</span><span class="o">=</span><span class="n">ppg2_dc</span><span class="p">,</span> <span class="n">ac2</span><span class="o">=</span><span class="n">ppg2_ac</span><span class="p">,</span> <span class="n">coefs</span><span class="o">=</span><span class="n">coefs</span><span class="p">)</span>
<a id="__codelineno-0-275" name="__codelineno-0-275"></a>
<a id="__codelineno-0-276" name="__codelineno-0-276"></a>    <span class="k">return</span> <span class="n">spo2</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="physiokit.ppg.metrics.compute_spo2_in_time" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">compute_spo2_in_time</span><span class="p">(</span><span class="n">ppg1</span><span class="p">,</span> <span class="n">ppg2</span><span class="p">,</span> <span class="n">coefs</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">sample_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Compute SpO2 from PPG signals in time domain.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>ppg1</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/array.html#module-array">array</a></code>)
        –
        <div class="doc-md-description">
          <p>1st PPG signal (e.g RED).</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>ppg2</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/array.html#module-array">array</a></code>)
        –
        <div class="doc-md-description">
          <p>2nd PPG signal (e.g. IR).</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>coefs</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code>, default:
                <code>(1, 0, 0)</code>
)
        –
        <div class="doc-md-description">
          <p>Calibration coefficients. Defaults to (1, 0, 0).</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>sample_rate</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>1000</code>
)
        –
        <div class="doc-md-description">
          <p>Sampling rate in Hz. Defaults to 1000 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>lowcut</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>0.5</code>
)
        –
        <div class="doc-md-description">
          <p>Lowcut frequency in Hz. Defaults to 0.5 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>highcut</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>4</code>
)
        –
        <div class="doc-md-description">
          <p>Highcut frequency in Hz. Defaults to 4.0 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>order</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                <code>3</code>
)
        –
        <div class="doc-md-description">
          <p>Order of filter. Defaults to 3.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
<b><code>float</code></b> (            <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
)        –
        <div class="doc-md-description">
          <p>SpO2 value</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>physiokit/ppg/metrics.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-175" name="__codelineno-0-175"></a><span class="k">def</span> <span class="nf">compute_spo2_in_time</span><span class="p">(</span>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a>    <span class="n">ppg1</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a>    <span class="n">ppg2</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a>    <span class="n">coefs</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="n">sample_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="n">lowcut</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>    <span class="n">highcut</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>    <span class="n">order</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute SpO2 from PPG signals in time domain.</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a><span class="sd">        ppg1 (array): 1st PPG signal (e.g RED).</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a><span class="sd">        ppg2 (array): 2nd PPG signal (e.g. IR).</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a><span class="sd">        coefs (tuple[float, float, float], optional): Calibration coefficients. Defaults to (1, 0, 0).</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a><span class="sd">        sample_rate (float, optional): Sampling rate in Hz. Defaults to 1000 Hz.</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a><span class="sd">        lowcut (float, optional): Lowcut frequency in Hz. Defaults to 0.5 Hz.</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a><span class="sd">        highcut (float, optional): Highcut frequency in Hz. Defaults to 4.0 Hz.</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a><span class="sd">        order (int, optional): Order of filter. Defaults to 3.</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a><span class="sd">        float: SpO2 value</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="c1"># Compute DC</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>    <span class="n">ppg1_dc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ppg1</span><span class="p">)</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>    <span class="n">ppg2_dc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ppg2</span><span class="p">)</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>    <span class="c1"># Bandpass filter</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>    <span class="n">ppg1_clean</span> <span class="o">=</span> <span class="n">filter_signal</span><span class="p">(</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>        <span class="n">data</span><span class="o">=</span><span class="n">ppg1</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="n">lowcut</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="n">highcut</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">forward_backward</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>    <span class="p">)</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>    <span class="n">ppg2_clean</span> <span class="o">=</span> <span class="n">filter_signal</span><span class="p">(</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>        <span class="n">data</span><span class="o">=</span><span class="n">ppg2</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="n">lowcut</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="n">highcut</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">forward_backward</span><span class="o">=</span><span class="kc">True</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>    <span class="p">)</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>    <span class="c1"># Compute AC via RMS</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>    <span class="n">ppg1_ac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ppg1_clean</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>    <span class="n">ppg2_ac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ppg2_clean</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>    <span class="n">spo2</span> <span class="o">=</span> <span class="n">compute_spo2_from_perfusion</span><span class="p">(</span><span class="n">dc1</span><span class="o">=</span><span class="n">ppg1_dc</span><span class="p">,</span> <span class="n">ac1</span><span class="o">=</span><span class="n">ppg1_ac</span><span class="p">,</span> <span class="n">dc2</span><span class="o">=</span><span class="n">ppg2_dc</span><span class="p">,</span> <span class="n">ac2</span><span class="o">=</span><span class="n">ppg2_ac</span><span class="p">,</span> <span class="n">coefs</span><span class="o">=</span><span class="n">coefs</span><span class="p">)</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="k">return</span> <span class="n">spo2</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="physiokit.ppg.metrics.derive_respiratory_rate" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">derive_respiratory_rate</span><span class="p">(</span><span class="n">ppg</span><span class="p">,</span> <span class="n">peaks</span><span class="p">,</span> <span class="n">troughs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rri</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;rifv&#39;</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.85</span><span class="p">,</span> <span class="n">interpolate_method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Derive respiratory rate from PPG signal using given method.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>ppg</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/array.html#module-array">array</a></code>)
        –
        <div class="doc-md-description">
          <p>PPG signal.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>peaks</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/array.html#module-array">array</a></code>)
        –
        <div class="doc-md-description">
          <p>Peaks of PPG signal.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>troughs</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/array.html#module-array">array</a></code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>Troughs of PPG signal. Defaults to None.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>rri</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/array.html#module-array">array</a></code>, default:
                <code>None</code>
)
        –
        <div class="doc-md-description">
          <p>Respiratory interval. Defaults to None.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>sample_rate</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>1000</code>
)
        –
        <div class="doc-md-description">
          <p>Sampling rate in Hz. Defaults to 1000 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>method</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>, default:
                <code>&#39;rifv&#39;</code>
)
        –
        <div class="doc-md-description">
          <p>Method to compute respiratory rate. Defaults to 'riav'.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>lowcut</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>0.1</code>
)
        –
        <div class="doc-md-description">
          <p>Lowcut frequency in Hz. Defaults to 0.1 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>highcut</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>1.0</code>
)
        –
        <div class="doc-md-description">
          <p>Highcut frequency in Hz. Defaults to 1.0 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>order</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                <code>3</code>
)
        –
        <div class="doc-md-description">
          <p>Order of filter. Defaults to 3.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>threshold</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>0.85</code>
)
        –
        <div class="doc-md-description">
          <p>Threshold for peak detection. Defaults to 0.85.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>interpolate_method</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>, default:
                <code>&#39;linear&#39;</code>
)
        –
        <div class="doc-md-description">
          <p>Interpolation method. Defaults to 'linear'.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code>
        –
        <div class="doc-md-description">
          <p>tuple[float, float]: Respiratory rate (BPM) and qos metric.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>physiokit/ppg/metrics.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="k">def</span> <span class="nf">derive_respiratory_rate</span><span class="p">(</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="n">ppg</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">peaks</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">troughs</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">rri</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">sample_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="n">method</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;riav&quot;</span><span class="p">,</span> <span class="s2">&quot;riiv&quot;</span><span class="p">,</span> <span class="s2">&quot;rifv&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;rifv&quot;</span><span class="p">,</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="n">lowcut</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="n">highcut</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="n">order</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mf">0.85</span><span class="p">,</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="n">interpolate_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Derive respiratory rate from PPG signal using given method.</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a><span class="sd">        ppg (array): PPG signal.</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a><span class="sd">        peaks (array): Peaks of PPG signal.</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a><span class="sd">        troughs (array, optional): Troughs of PPG signal. Defaults to None.</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a><span class="sd">        rri (array, optional): Respiratory interval. Defaults to None.</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a><span class="sd">        sample_rate (float, optional): Sampling rate in Hz. Defaults to 1000 Hz.</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a><span class="sd">        method (str, optional): Method to compute respiratory rate. Defaults to &#39;riav&#39;.</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a><span class="sd">        lowcut (float, optional): Lowcut frequency in Hz. Defaults to 0.1 Hz.</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a><span class="sd">        highcut (float, optional): Highcut frequency in Hz. Defaults to 1.0 Hz.</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a><span class="sd">        order (int, optional): Order of filter. Defaults to 3.</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="sd">        threshold (float, optional): Threshold for peak detection. Defaults to 0.85.</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a><span class="sd">        interpolate_method (str, optional): Interpolation method. Defaults to &#39;linear&#39;.</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a><span class="sd">        tuple[float, float]: Respiratory rate (BPM) and qos metric.</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="k">if</span> <span class="n">peaks</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;At least 4 peaks are required to compute respiratory rate&quot;</span><span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">peaks</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">peaks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>    <span class="k">match</span> <span class="n">method</span><span class="p">:</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="k">case</span> <span class="s2">&quot;riav&quot;</span><span class="p">:</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="n">rsp</span> <span class="o">=</span> <span class="n">ppg</span><span class="p">[</span><span class="n">peaks</span><span class="p">]</span> <span class="o">-</span> <span class="n">ppg</span><span class="p">[</span><span class="n">troughs</span><span class="p">]</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>        <span class="k">case</span> <span class="s2">&quot;riiv&quot;</span><span class="p">:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>            <span class="n">rsp</span> <span class="o">=</span> <span class="n">ppg</span><span class="p">[</span><span class="n">peaks</span><span class="p">]</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="k">case</span> <span class="s2">&quot;rifv&quot;</span><span class="p">:</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>            <span class="n">rsp</span> <span class="o">=</span> <span class="n">rri</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Method </span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2"> not implemented&quot;</span><span class="p">)</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>    <span class="n">rsp</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="n">rsp</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">interpolate_method</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;extrapolate&quot;</span><span class="p">)(</span><span class="n">ts</span><span class="p">)</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="n">rsp</span> <span class="o">=</span> <span class="n">filter_signal</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="n">lowcut</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="n">highcut</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>    <span class="n">freqs</span><span class="p">,</span> <span class="n">rsp_sp</span> <span class="o">=</span> <span class="n">compute_fft</span><span class="p">(</span><span class="n">rsp</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">)</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>    <span class="n">l_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">freqs</span> <span class="o">&gt;=</span> <span class="n">lowcut</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>    <span class="n">r_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">freqs</span> <span class="o">&gt;=</span> <span class="n">highcut</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>    <span class="n">rsp_ps</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">rsp_sp</span><span class="p">)</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="n">freqs</span> <span class="o">=</span> <span class="n">freqs</span><span class="p">[</span><span class="n">l_idx</span><span class="p">:</span><span class="n">r_idx</span><span class="p">]</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>    <span class="n">rsp_ps</span> <span class="o">=</span> <span class="n">rsp_ps</span><span class="p">[</span><span class="n">l_idx</span><span class="p">:</span><span class="n">r_idx</span><span class="p">]</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>    <span class="n">fft_pk_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">rsp_ps</span><span class="p">)</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="k">if</span> <span class="n">threshold</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="n">fft_pk_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rsp_ps</span> <span class="o">&gt;</span> <span class="n">threshold</span> <span class="o">*</span> <span class="n">rsp_ps</span><span class="p">[</span><span class="n">fft_pk_idx</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="n">fft_pk_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">fft_pk_idx</span><span class="p">]</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>    <span class="n">rsp_bpm_weights</span> <span class="o">=</span> <span class="n">rsp_ps</span><span class="p">[</span><span class="n">fft_pk_indices</span><span class="p">]</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>    <span class="n">tgt_pwr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rsp_bpm_weights</span><span class="p">)</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="n">qos</span> <span class="o">=</span> <span class="n">tgt_pwr</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rsp_ps</span><span class="p">)</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">rsp_bpm</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rsp_bpm_weights</span> <span class="o">*</span> <span class="n">freqs</span><span class="p">[</span><span class="n">fft_pk_indices</span><span class="p">])</span> <span class="o">/</span> <span class="n">tgt_pwr</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>    <span class="k">return</span> <span class="n">rsp_bpm</span><span class="p">,</span> <span class="n">qos</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="physiokit.ppg.peaks" class="doc doc-heading">
          <code>physiokit.ppg.peaks</code>


</h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="physiokit.ppg.peaks.compute_rr_intervals" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">compute_rr_intervals</span><span class="p">(</span><span class="n">peaks</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Compute RR intervals from R peaks.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>peaks</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/array.html#module-array">array</a></code>)
        –
        <div class="doc-md-description">
          <p>R peaks.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="numpy.NDArray">NDArray</span></code>
        –
        <div class="doc-md-description">
          <p>npt.NDArray: RR intervals.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>physiokit/ppg/peaks.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-109" name="__codelineno-0-109"></a><span class="k">def</span> <span class="nf">compute_rr_intervals</span><span class="p">(</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>    <span class="n">peaks</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">:</span>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute RR intervals from R peaks.</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a><span class="sd">        peaks (array): R peaks.</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a><span class="sd">        npt.NDArray: RR intervals.</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>    <span class="n">rr_ints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">peaks</span><span class="p">)</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>    <span class="k">if</span> <span class="n">rr_ints</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>        <span class="k">return</span> <span class="n">rr_ints</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>    <span class="n">rr_ints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">rr_ints</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rr_ints</span><span class="p">))</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>    <span class="k">return</span> <span class="n">rr_ints</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="physiokit.ppg.peaks.filter_peaks" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">filter_peaks</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">min_rr</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">max_rr</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">min_delta</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Filter out peaks with RR intervals outside of normal range.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>peaks</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/array.html#module-array">array</a></code>)
        –
        <div class="doc-md-description">
          <p>Systolic peaks.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>sample_rate</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>1000</code>
)
        –
        <div class="doc-md-description">
          <p>Sampling rate in Hz. Defaults to 1000 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>min_rr</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>0.3</code>
)
        –
        <div class="doc-md-description">
          <p>Minimum RR interval in seconds. Defaults to 0.3 s.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>max_rr</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>2.0</code>
)
        –
        <div class="doc-md-description">
          <p>Maximum RR interval in seconds. Defaults to 2.0 s.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>min_delta</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>0.3</code>
)
        –
        <div class="doc-md-description">
          <p>Minimum RR interval delta. Defaults to 0.3.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="numpy.NDArray">NDArray</span></code>
        –
        <div class="doc-md-description">
          <p>npt.NDArray: Filtered peaks.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>physiokit/ppg/peaks.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-74" name="__codelineno-0-74"></a><span class="k">def</span> <span class="nf">filter_peaks</span><span class="p">(</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="n">peaks</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="n">sample_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="n">min_rr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="n">max_rr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">min_delta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">:</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter out peaks with RR intervals outside of normal range.</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a><span class="sd">        peaks (array): Systolic peaks.</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a><span class="sd">        sample_rate (float, optional): Sampling rate in Hz. Defaults to 1000 Hz.</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a><span class="sd">        min_rr (float, optional): Minimum RR interval in seconds. Defaults to 0.3 s.</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a><span class="sd">        max_rr (float, optional): Maximum RR interval in seconds. Defaults to 2.0 s.</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a><span class="sd">        min_delta (float, optional): Minimum RR interval delta. Defaults to 0.3.</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a><span class="sd">        npt.NDArray: Filtered peaks.</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="k">if</span> <span class="n">peaks</span><span class="o">.</span><span class="n">size</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>        <span class="k">return</span> <span class="n">peaks</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>    <span class="c1"># Capture RR intervals</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">rr_ints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">peaks</span><span class="p">)</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">rr_ints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">rr_ints</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rr_ints</span><span class="p">))</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>    <span class="c1"># Filter out peaks with RR intervals outside of normal range</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="n">rr_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">rr_ints</span> <span class="o">&lt;</span> <span class="n">min_rr</span> <span class="o">*</span> <span class="n">sample_rate</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">rr_ints</span> <span class="o">&gt;</span> <span class="n">max_rr</span> <span class="o">*</span> <span class="n">sample_rate</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>    <span class="c1"># Filter out peaks that deviate more than delta</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>    <span class="k">if</span> <span class="n">min_delta</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>        <span class="n">rr_mask</span> <span class="o">=</span> <span class="n">quotient_filter_mask</span><span class="p">(</span><span class="n">rr_ints</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">rr_mask</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="n">min_delta</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">min_delta</span><span class="p">)</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>    <span class="n">filt_peaks</span> <span class="o">=</span> <span class="n">peaks</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">rr_mask</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>    <span class="k">return</span> <span class="n">filt_peaks</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="physiokit.ppg.peaks.filter_rr_intervals" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">filter_rr_intervals</span><span class="p">(</span><span class="n">rr_ints</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">min_rr</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">max_rr</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">min_delta</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Filter out peaks with RR intervals outside of normal range.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>rr_ints</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/array.html#module-array">array</a></code>)
        –
        <div class="doc-md-description">
          <p>RR intervals.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>sample_rate</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>1000</code>
)
        –
        <div class="doc-md-description">
          <p>Sampling rate in Hz. Defaults to 1000 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>min_rr</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>0.3</code>
)
        –
        <div class="doc-md-description">
          <p>Minimum RR interval in seconds. Defaults to 0.3 s.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>max_rr</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>2.0</code>
)
        –
        <div class="doc-md-description">
          <p>Maximum RR interval in seconds. Defaults to 2.0 s.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>min_delta</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>0.3</code>
)
        –
        <div class="doc-md-description">
          <p>Minimum RR interval delta. Defaults to 0.3.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="numpy.NDArray">NDArray</span></code>
        –
        <div class="doc-md-description">
          <p>npt.NDArray: Filtered RR intervals.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>physiokit/ppg/peaks.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span>
<span class="normal"><a href="#__codelineno-0-150">150</a></span>
<span class="normal"><a href="#__codelineno-0-151">151</a></span>
<span class="normal"><a href="#__codelineno-0-152">152</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-128" name="__codelineno-0-128"></a><span class="k">def</span> <span class="nf">filter_rr_intervals</span><span class="p">(</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>    <span class="n">rr_ints</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">sample_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">min_rr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">max_rr</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">min_delta</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">:</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter out peaks with RR intervals outside of normal range.</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a><span class="sd">        rr_ints (array): RR intervals.</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a><span class="sd">        sample_rate (float, optional): Sampling rate in Hz. Defaults to 1000 Hz.</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a><span class="sd">        min_rr (float, optional): Minimum RR interval in seconds. Defaults to 0.3 s.</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a><span class="sd">        max_rr (float, optional): Maximum RR interval in seconds. Defaults to 2.0 s.</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a><span class="sd">        min_delta (float, optional): Minimum RR interval delta. Defaults to 0.3.</span>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a><span class="sd">        npt.NDArray: Filtered RR intervals.</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>    <span class="k">if</span> <span class="n">rr_ints</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>    <span class="c1"># Filter out peaks with RR intervals outside of normal range</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>    <span class="n">rr_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">rr_ints</span> <span class="o">&lt;</span> <span class="n">min_rr</span> <span class="o">*</span> <span class="n">sample_rate</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">rr_ints</span> <span class="o">&gt;</span> <span class="n">max_rr</span> <span class="o">*</span> <span class="n">sample_rate</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="c1"># Filter out peaks that deviate more than delta</span>
<a id="__codelineno-0-150" name="__codelineno-0-150"></a>    <span class="n">rr_mask</span> <span class="o">=</span> <span class="n">quotient_filter_mask</span><span class="p">(</span><span class="n">rr_ints</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">rr_mask</span><span class="p">,</span> <span class="n">lowcut</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="n">min_delta</span><span class="p">,</span> <span class="n">highcut</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">min_delta</span><span class="p">)</span>
<a id="__codelineno-0-151" name="__codelineno-0-151"></a>
<a id="__codelineno-0-152" name="__codelineno-0-152"></a>    <span class="k">return</span> <span class="n">rr_mask</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h4 id="physiokit.ppg.peaks.find_peaks" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">find_peaks</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">peak_window</span><span class="o">=</span><span class="mf">0.111</span><span class="p">,</span> <span class="n">beat_window</span><span class="o">=</span><span class="mf">0.667</span><span class="p">,</span> <span class="n">beat_offset</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">peak_delay</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Find systolic peaks in PPG signal.</p>
<p>Implementation based on Elgendi M, Norton I, Brearley M, Abbott D, Schuurmans D (2013) Systolic Peak Detection in
Acceleration Photoplethysmograms Measured from Emergency Responders in Tropical Conditions. PLoS ONE 8(10): e76585.
doi:10.1371/journal.pone.0076585.
Assumes input data is bandpass filtered with a lowcut of .5 Hz and a highcut of 8 Hz.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>data</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/array.html#module-array">array</a></code>)
        –
        <div class="doc-md-description">
          <p>PPG signal.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>sample_rate</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>1000</code>
)
        –
        <div class="doc-md-description">
          <p>Sampling rate in Hz. Defaults to 1000 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>peak_window</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>0.111</code>
)
        –
        <div class="doc-md-description">
          <p>Peak window in seconds. Defaults to 0.111 s.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>beat_window</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>0.667</code>
)
        –
        <div class="doc-md-description">
          <p>Beat window in seconds. Defaults to 0.667 s.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>beat_offset</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>0.02</code>
)
        –
        <div class="doc-md-description">
          <p>Beat offset in seconds. Defaults to 0.02 s.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>peak_delay</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>0.3</code>
)
        –
        <div class="doc-md-description">
          <p>Peak delay in seconds. Defaults to 0.3 s.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="numpy.NDArray">NDArray</span></code>
        –
        <div class="doc-md-description">
          <p>npt.NDArray: Peak locations.</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>physiokit/ppg/peaks.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span>
<span class="normal"><a href="#__codelineno-0-12">12</a></span>
<span class="normal"><a href="#__codelineno-0-13">13</a></span>
<span class="normal"><a href="#__codelineno-0-14">14</a></span>
<span class="normal"><a href="#__codelineno-0-15">15</a></span>
<span class="normal"><a href="#__codelineno-0-16">16</a></span>
<span class="normal"><a href="#__codelineno-0-17">17</a></span>
<span class="normal"><a href="#__codelineno-0-18">18</a></span>
<span class="normal"><a href="#__codelineno-0-19">19</a></span>
<span class="normal"><a href="#__codelineno-0-20">20</a></span>
<span class="normal"><a href="#__codelineno-0-21">21</a></span>
<span class="normal"><a href="#__codelineno-0-22">22</a></span>
<span class="normal"><a href="#__codelineno-0-23">23</a></span>
<span class="normal"><a href="#__codelineno-0-24">24</a></span>
<span class="normal"><a href="#__codelineno-0-25">25</a></span>
<span class="normal"><a href="#__codelineno-0-26">26</a></span>
<span class="normal"><a href="#__codelineno-0-27">27</a></span>
<span class="normal"><a href="#__codelineno-0-28">28</a></span>
<span class="normal"><a href="#__codelineno-0-29">29</a></span>
<span class="normal"><a href="#__codelineno-0-30">30</a></span>
<span class="normal"><a href="#__codelineno-0-31">31</a></span>
<span class="normal"><a href="#__codelineno-0-32">32</a></span>
<span class="normal"><a href="#__codelineno-0-33">33</a></span>
<span class="normal"><a href="#__codelineno-0-34">34</a></span>
<span class="normal"><a href="#__codelineno-0-35">35</a></span>
<span class="normal"><a href="#__codelineno-0-36">36</a></span>
<span class="normal"><a href="#__codelineno-0-37">37</a></span>
<span class="normal"><a href="#__codelineno-0-38">38</a></span>
<span class="normal"><a href="#__codelineno-0-39">39</a></span>
<span class="normal"><a href="#__codelineno-0-40">40</a></span>
<span class="normal"><a href="#__codelineno-0-41">41</a></span>
<span class="normal"><a href="#__codelineno-0-42">42</a></span>
<span class="normal"><a href="#__codelineno-0-43">43</a></span>
<span class="normal"><a href="#__codelineno-0-44">44</a></span>
<span class="normal"><a href="#__codelineno-0-45">45</a></span>
<span class="normal"><a href="#__codelineno-0-46">46</a></span>
<span class="normal"><a href="#__codelineno-0-47">47</a></span>
<span class="normal"><a href="#__codelineno-0-48">48</a></span>
<span class="normal"><a href="#__codelineno-0-49">49</a></span>
<span class="normal"><a href="#__codelineno-0-50">50</a></span>
<span class="normal"><a href="#__codelineno-0-51">51</a></span>
<span class="normal"><a href="#__codelineno-0-52">52</a></span>
<span class="normal"><a href="#__codelineno-0-53">53</a></span>
<span class="normal"><a href="#__codelineno-0-54">54</a></span>
<span class="normal"><a href="#__codelineno-0-55">55</a></span>
<span class="normal"><a href="#__codelineno-0-56">56</a></span>
<span class="normal"><a href="#__codelineno-0-57">57</a></span>
<span class="normal"><a href="#__codelineno-0-58">58</a></span>
<span class="normal"><a href="#__codelineno-0-59">59</a></span>
<span class="normal"><a href="#__codelineno-0-60">60</a></span>
<span class="normal"><a href="#__codelineno-0-61">61</a></span>
<span class="normal"><a href="#__codelineno-0-62">62</a></span>
<span class="normal"><a href="#__codelineno-0-63">63</a></span>
<span class="normal"><a href="#__codelineno-0-64">64</a></span>
<span class="normal"><a href="#__codelineno-0-65">65</a></span>
<span class="normal"><a href="#__codelineno-0-66">66</a></span>
<span class="normal"><a href="#__codelineno-0-67">67</a></span>
<span class="normal"><a href="#__codelineno-0-68">68</a></span>
<span class="normal"><a href="#__codelineno-0-69">69</a></span>
<span class="normal"><a href="#__codelineno-0-70">70</a></span>
<span class="normal"><a href="#__codelineno-0-71">71</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="k">def</span> <span class="nf">find_peaks</span><span class="p">(</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    <span class="n">data</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="n">sample_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="n">peak_window</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.111</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">beat_window</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.667</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="n">beat_offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.02</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a>    <span class="n">peak_delay</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Find systolic peaks in PPG signal.</span>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">    Implementation based on Elgendi M, Norton I, Brearley M, Abbott D, Schuurmans D (2013) Systolic Peak Detection in</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">    Acceleration Photoplethysmograms Measured from Emergency Responders in Tropical Conditions. PLoS ONE 8(10): e76585.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">    doi:10.1371/journal.pone.0076585.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">    Assumes input data is bandpass filtered with a lowcut of .5 Hz and a highcut of 8 Hz.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">        data (array): PPG signal.</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        sample_rate (float, optional): Sampling rate in Hz. Defaults to 1000 Hz.</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">        peak_window (float, optional): Peak window in seconds. Defaults to 0.111 s.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="sd">        beat_window (float, optional): Beat window in seconds. Defaults to 0.667 s.</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="sd">        beat_offset (float, optional): Beat offset in seconds. Defaults to 0.02 s.</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a><span class="sd">        peak_delay (float, optional): Peak delay in seconds. Defaults to 0.3 s.</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a><span class="sd">        npt.NDArray: Peak locations.</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>    <span class="c1"># Clip negative values and square the signal</span>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="n">sqrd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>    <span class="c1"># Apply 1st moving average filter</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>    <span class="n">ma_peak_kernel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">peak_window</span> <span class="o">*</span> <span class="n">sample_rate</span><span class="p">))</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>    <span class="n">ma_peak</span> <span class="o">=</span> <span class="n">spn</span><span class="o">.</span><span class="n">uniform_filter1d</span><span class="p">(</span><span class="n">sqrd</span><span class="p">,</span> <span class="n">ma_peak_kernel</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="c1"># Apply 2nd moving average filter</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>    <span class="n">ma_beat_kernel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">beat_window</span> <span class="o">*</span> <span class="n">sample_rate</span><span class="p">))</span>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="n">ma_beat</span> <span class="o">=</span> <span class="n">spn</span><span class="o">.</span><span class="n">uniform_filter1d</span><span class="p">(</span><span class="n">sqrd</span><span class="p">,</span> <span class="n">ma_beat_kernel</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;nearest&quot;</span><span class="p">)</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="c1"># Thresholds</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">min_height</span> <span class="o">=</span> <span class="n">ma_beat</span> <span class="o">+</span> <span class="n">beat_offset</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sqrd</span><span class="p">)</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="n">min_width</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">peak_window</span> <span class="o">*</span> <span class="n">sample_rate</span><span class="p">))</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="n">min_delay</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">peak_delay</span> <span class="o">*</span> <span class="n">sample_rate</span><span class="p">))</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="c1"># Identify wave boundaries</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="n">waves</span> <span class="o">=</span> <span class="n">ma_peak</span> <span class="o">&gt;</span> <span class="n">min_height</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="n">beg_waves</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">waves</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">waves</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">end_waves</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">waves</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span><span class="n">waves</span><span class="p">[</span><span class="mi">1</span><span class="p">:])))[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>    <span class="n">end_waves</span> <span class="o">=</span> <span class="n">end_waves</span><span class="p">[</span><span class="n">end_waves</span> <span class="o">&gt;</span> <span class="n">beg_waves</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="c1"># Identify systolic peaks</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">peaks</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">beg_waves</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">end_waves</span><span class="o">.</span><span class="n">size</span><span class="p">)):</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>        <span class="n">beg</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">beg_waves</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">end_waves</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>        <span class="n">peak</span> <span class="o">=</span> <span class="n">beg</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">beg</span><span class="p">:</span><span class="n">end</span><span class="p">])</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>        <span class="n">peak_width</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">beg</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>        <span class="n">peak_delay</span> <span class="o">=</span> <span class="n">peak</span> <span class="o">-</span> <span class="n">peaks</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">if</span> <span class="n">peaks</span> <span class="k">else</span> <span class="n">min_delay</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>        <span class="c1"># Enforce minimum length and delay between peaks</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">peak_width</span> <span class="o">&lt;</span> <span class="n">min_width</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">peak_delay</span> <span class="o">&lt;</span> <span class="n">min_delay</span><span class="p">):</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>            <span class="k">continue</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>        <span class="n">peaks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">peak</span><span class="p">)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>    <span class="c1"># END FOR</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">peaks</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="physiokit.ppg.synthesize" class="doc doc-heading">
          <code>physiokit.ppg.synthesize</code>


</h3>

  <div class="doc doc-contents first">

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h4 id="physiokit.ppg.synthesize.synthesize" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">synthesize</span><span class="p">(</span><span class="n">signal_length</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">sample_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">heart_rate</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">frequency_modulation</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">ibi_randomness</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span></code>

</h4>


  <div class="doc doc-contents ">
  
      <p>Generate synthetic PPG signal. Utilize pk.signal.noise methods to make more realistic.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>signal_length</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>, default:
                <code>10000</code>
)
        –
        <div class="doc-md-description">
          <p>Length of signal in samples. Defaults to 10000.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>sample_rate</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>1000</code>
)
        –
        <div class="doc-md-description">
          <p>Sample rate in Hz. Defaults to 1000 Hz.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>heart_rate</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>60</code>
)
        –
        <div class="doc-md-description">
          <p>Heart rate in BPM. Defaults to 60 BPM.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>frequency_modulation</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>0.3</code>
)
        –
        <div class="doc-md-description">
          <p>Frequency modulation strength [0,1]. Defaults to 0.3.</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>ibi_randomness</code></b>
            (<code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>, default:
                <code>0.1</code>
)
        –
        <div class="doc-md-description">
          <p>IBI randomness in range [0,1]. Defaults to 0.1.</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<span title="numpy.NDArray">NDArray</span>, <span title="numpy.NDArray">NDArray</span>, <span title="numpy.NDArray">NDArray</span>]</code>
        –
        <div class="doc-md-description">
          <p>npt.NDArray: Synthetic PPG, segmentation mask, fiducial mask</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>physiokit/ppg/synthesize.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-8">  8</a></span>
<span class="normal"><a href="#__codelineno-0-9">  9</a></span>
<span class="normal"><a href="#__codelineno-0-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-0-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-0-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-0-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-0-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-0-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-0-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-0-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-0-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-0-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-0-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-0-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-0-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-0-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-0-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-0-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-0-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-0-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-0-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-0-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-0-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-0-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-0-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-0-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-0-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-0-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-0-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-0-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-0-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-0-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-0-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-0-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-0-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-0-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="k">def</span> <span class="nf">synthesize</span><span class="p">(</span>
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    <span class="n">signal_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span>
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="n">sample_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    <span class="n">heart_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span>
<a id="__codelineno-0-12" name="__codelineno-0-12"></a>    <span class="n">frequency_modulation</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
<a id="__codelineno-0-13" name="__codelineno-0-13"></a>    <span class="n">ibi_randomness</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
<a id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">]:</span>
<a id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate synthetic PPG signal. Utilize pk.signal.noise methods to make more realistic.</span>
<a id="__codelineno-0-16" name="__codelineno-0-16"></a>
<a id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="sd">        signal_length (int, optional): Length of signal in samples. Defaults to 10000.</span>
<a id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="sd">        sample_rate (float, optional): Sample rate in Hz. Defaults to 1000 Hz.</span>
<a id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="sd">        heart_rate (float, optional): Heart rate in BPM. Defaults to 60 BPM.</span>
<a id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="sd">        frequency_modulation (float, optional): Frequency modulation strength [0,1]. Defaults to 0.3.</span>
<a id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="sd">        ibi_randomness (float, optional): IBI randomness in range [0,1]. Defaults to 0.1.</span>
<a id="__codelineno-0-23" name="__codelineno-0-23"></a>
<a id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="sd">    Returns:</span>
<a id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="sd">        npt.NDArray: Synthetic PPG, segmentation mask, fiducial mask</span>
<a id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-27" name="__codelineno-0-27"></a>    <span class="n">duration</span> <span class="o">=</span> <span class="n">signal_length</span> <span class="o">/</span> <span class="n">sample_rate</span>
<a id="__codelineno-0-28" name="__codelineno-0-28"></a>    <span class="n">period</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">/</span> <span class="n">heart_rate</span>  <span class="c1"># in seconds</span>
<a id="__codelineno-0-29" name="__codelineno-0-29"></a>    <span class="n">n_period</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">duration</span> <span class="o">/</span> <span class="n">period</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-0-30" name="__codelineno-0-30"></a>    <span class="n">periods</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n_period</span><span class="p">)</span> <span class="o">*</span> <span class="n">period</span>
<a id="__codelineno-0-31" name="__codelineno-0-31"></a>
<a id="__codelineno-0-32" name="__codelineno-0-32"></a>    <span class="c1"># Mark onset of each wave in seconds</span>
<a id="__codelineno-0-33" name="__codelineno-0-33"></a>    <span class="n">x_onset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">periods</span><span class="p">)</span>
<a id="__codelineno-0-34" name="__codelineno-0-34"></a>    <span class="n">x_onset</span> <span class="o">-=</span> <span class="n">x_onset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># make sure seconds start at zero</span>
<a id="__codelineno-0-35" name="__codelineno-0-35"></a>
<a id="__codelineno-0-36" name="__codelineno-0-36"></a>    <span class="c1"># Add respiratory sinus arrythmia (RSA)</span>
<a id="__codelineno-0-37" name="__codelineno-0-37"></a>    <span class="n">periods</span><span class="p">,</span> <span class="n">x_onset</span> <span class="o">=</span> <span class="n">_frequency_modulation</span><span class="p">(</span>
<a id="__codelineno-0-38" name="__codelineno-0-38"></a>        <span class="n">periods</span><span class="p">,</span>
<a id="__codelineno-0-39" name="__codelineno-0-39"></a>        <span class="n">x_onset</span><span class="p">,</span>
<a id="__codelineno-0-40" name="__codelineno-0-40"></a>        <span class="n">modulation_frequency</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<a id="__codelineno-0-41" name="__codelineno-0-41"></a>        <span class="n">modulation_strength</span><span class="o">=</span><span class="n">frequency_modulation</span><span class="p">,</span>
<a id="__codelineno-0-42" name="__codelineno-0-42"></a>    <span class="p">)</span>
<a id="__codelineno-0-43" name="__codelineno-0-43"></a>
<a id="__codelineno-0-44" name="__codelineno-0-44"></a>    <span class="c1"># Modulate onset of each wave randomly ~[0, ibi_randomness]</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="n">x_onset</span> <span class="o">=</span> <span class="n">_random_x_offset</span><span class="p">(</span><span class="n">x_onset</span><span class="p">,</span> <span class="n">ibi_randomness</span><span class="p">)</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="n">y_onset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">n_period</span><span class="p">)</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="c1"># Create systolic peaks within the waves in seconds</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="n">x_sys</span> <span class="o">=</span> <span class="n">x_onset</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.175</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">n_period</span><span class="p">)</span> <span class="o">*</span> <span class="n">periods</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="n">y_sys</span> <span class="o">=</span> <span class="n">y_onset</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">n_period</span><span class="p">)</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="c1"># Create dicrotic notches within the waves in seconds</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a>    <span class="n">x_notch</span> <span class="o">=</span> <span class="n">x_onset</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">n_period</span><span class="p">)</span> <span class="o">*</span> <span class="n">periods</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>    <span class="n">y_notch</span> <span class="o">=</span> <span class="n">y_sys</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.49</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">n_period</span><span class="p">)</span>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a>    <span class="c1"># Create diastolic peaks within the waves in seconds</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a>    <span class="n">x_dia</span> <span class="o">=</span> <span class="n">x_onset</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">n_period</span><span class="p">)</span> <span class="o">*</span> <span class="n">periods</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a>    <span class="n">y_dia</span> <span class="o">=</span> <span class="n">y_sys</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.51</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">n_period</span><span class="p">)</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a>    <span class="c1"># Convert seconds to sample</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a>    <span class="n">x_onset_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x_onset</span> <span class="o">*</span> <span class="n">sample_rate</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a>    <span class="n">x_sys_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x_sys</span> <span class="o">*</span> <span class="n">sample_rate</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a>    <span class="n">x_notch_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x_notch</span> <span class="o">*</span> <span class="n">sample_rate</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a>    <span class="n">x_dia_n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">x_dia</span> <span class="o">*</span> <span class="n">sample_rate</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a>    <span class="c1"># Concatenate all landmarks and sort them</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a>    <span class="n">x_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">x_onset_n</span><span class="p">,</span> <span class="n">x_sys_n</span><span class="p">,</span> <span class="n">x_notch_n</span><span class="p">,</span> <span class="n">x_dia_n</span><span class="p">))</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a>    <span class="n">x_all</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;mergesort&quot;</span><span class="p">)</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>    <span class="n">y_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_period</span> <span class="o">*</span> <span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a>    <span class="n">y_all</span><span class="p">[</span><span class="mi">0</span><span class="p">::</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_onset</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a>    <span class="n">y_all</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_sys</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a>    <span class="n">y_all</span><span class="p">[</span><span class="mi">2</span><span class="p">::</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_notch</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="n">y_all</span><span class="p">[</span><span class="mi">3</span><span class="p">::</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_dia</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="c1"># Interpolate a continuous signal between the landmarks (i.e., Cartesian coordinates).</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">duration</span> <span class="o">*</span> <span class="n">sample_rate</span><span class="p">)))</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="c1"># Create fiducial mask</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="n">fids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">fids</span><span class="p">[</span><span class="n">x_sys_n</span><span class="p">[</span><span class="n">x_sys_n</span> <span class="o">&lt;</span> <span class="n">fids</span><span class="o">.</span><span class="n">size</span><span class="p">]]</span> <span class="o">=</span> <span class="n">PpgFiducial</span><span class="o">.</span><span class="n">systolic_peak</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="n">fids</span><span class="p">[</span><span class="n">x_notch_n</span><span class="p">[</span><span class="n">x_notch_n</span> <span class="o">&lt;</span> <span class="n">fids</span><span class="o">.</span><span class="n">size</span><span class="p">]]</span> <span class="o">=</span> <span class="n">PpgFiducial</span><span class="o">.</span><span class="n">dicrotic_notch</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">fids</span><span class="p">[</span><span class="n">x_dia_n</span><span class="p">[</span><span class="n">x_dia_n</span> <span class="o">&lt;</span> <span class="n">fids</span><span class="o">.</span><span class="n">size</span><span class="p">]]</span> <span class="o">=</span> <span class="n">PpgFiducial</span><span class="o">.</span><span class="n">diastolic_peak</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="c1"># Create segmentation mask</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">x_sys_seg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">x_onset_n</span><span class="p">,</span> <span class="n">x_dia_n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">x_sys_seg</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s2">&quot;mergesort&quot;</span><span class="p">)</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>    <span class="n">segs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">PpgSegment</span><span class="o">.</span><span class="n">diastolic</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_sys_seg</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="n">segs</span><span class="p">[</span><span class="n">x_sys_seg</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">]</span> <span class="p">:</span> <span class="n">x_sys_seg</span><span class="p">[</span><span class="mi">2</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">PpgSegment</span><span class="o">.</span><span class="n">systolic</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>    <span class="c1"># Interpolate</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>    <span class="n">interp_function</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">Akima1DInterpolator</span><span class="p">(</span><span class="n">x_all</span><span class="p">,</span> <span class="n">y_all</span><span class="p">)</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>    <span class="n">ppg</span> <span class="o">=</span> <span class="n">interp_function</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>    <span class="n">ppg</span> <span class="o">=</span> <span class="n">ppg</span><span class="p">[:</span><span class="n">signal_length</span><span class="p">]</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>    <span class="n">segs</span> <span class="o">=</span> <span class="n">segs</span><span class="p">[:</span><span class="n">signal_length</span><span class="p">]</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>    <span class="n">fids</span> <span class="o">=</span> <span class="n">fids</span><span class="p">[:</span><span class="n">signal_length</span><span class="p">]</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>    <span class="k">return</span> <span class="n">ppg</span><span class="p">,</span> <span class="n">segs</span><span class="p">,</span> <span class="n">fids</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 Ambiq
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.tabs.link"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.e1c3ead8.min.js"></script>
      
        <script src="../../js/termynal.js"></script>
      
        <script src="../../js/custom.js"></script>
      
    
  </body>
</html>